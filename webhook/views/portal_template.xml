<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id = "portal_layout_inherit"
              inherit_id = "portal.portal_layout">
        <xpath expr="//div[@class='o_portal_my_security mt-3']" position="after">
            <div class = "o_portal_my_webhooks mt-3">
                <h4>Webhooks</h4>
                <hr class="mt-1 mb-1"/>
                <a href="/my/webhook/"><i class="fa fa-pencil mx-1"/>Manage Webhooks</a>
            </div>
        </xpath>
    </template>

    <template id = "portal_my_webhook">
        <t t-call = "portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Webhooks</t>
                <ul class="nav">
                  <a class="nav-item ">
                    <a class="nav-link active o_portal_new_subscription" href="#">Add</a>
                  </a>
                  <a class="nav-item">
                    <a class="nav-link o_portal_webhook_delete_subscription" href="#">Delete</a>
                  </a>
                </ul>
            </t>

        <div t-attf-class="table-responsive border rounded border-top-0 #{classes if classes else ''}">
            <table class="table rounded mb-0 bg-white o_portal_my_doc_table">
                <t t-out="0"/>
                <thead>
                    <tr class="active">
                        <th><input type="checkbox" id="checkAll" class = "o_portal_webhook_select_all" aria-label="Check webhooks"/></th>
                        <th class="text-left">Event</th>
                        <th class="col-6">URL</th>
                        <th>Description</th>
                        <th class = "text-right">Created</th>
                    </tr>
                </thead>
                <tbody>
                    <tr t-foreach = "request.env.user.webhook_subscriptions" t-as = "webhook_subscription">
                        <td><input type="checkbox" class="checkbox" aria-label="Check webhooks" t-att-id="webhook_subscription.id"/></td>
                        <td class="text-left">
                                <a href = "#" t-att-id="webhook_subscription.id" role = "button" class = "btn-link o_portal_edit_subscription" t-esc="webhook_subscription.webhook.name"/>
                        </td>
                        <td><span t-field="webhook_subscription.webhook_url"/></td>
                        <td></td>
                        <td class = "text-left w-200"><a t-field="webhook_subscription.create_date"/></td>
                    </tr>
                </tbody>
            </table>
        </div>
        </t>
    </template>
</odoo>